<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KI-Soforthilfe Stromausfall</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body{margin:0;font-family:'Montserrat',sans-serif;background:#f0f2f5;color:#222;}
h1,h2,h3{margin:0 0 15px;}
button{padding:12px 20px;border:none;border-radius:8px;background:#25d366;color:white;cursor:pointer;font-weight:600;}
button:disabled{opacity:0.5;cursor:not-allowed;}
button:hover:not(:disabled){background:#1ebe57;}
nav{display:flex;justify-content:flex-end;gap:25px;padding:15px 20px;background:white;box-shadow:0 2px 8px rgba(0,0,0,0.05);}
nav a{color:#222;text-decoration:none;font-weight:600;}
header{padding:40px 20px;text-align:center;}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;z-index:1000;padding:10px;}
.modal-content{background:white;padding:20px;border-radius:12px;max-width:600px;width:100%;max-height:90vh;overflow:auto;}
.summary{background:#f7f7f7;padding:12px;border-radius:8px;font-size:14px;margin-bottom:10px;white-space:pre-wrap;}
.info-box{background:#fff3cd;padding:10px;border-radius:8px;border:1px solid #ffeeba;margin-bottom:10px;font-size:14px;}
#messages{height:200px;overflow-y:auto;border:1px solid #ccc;padding:10px;margin:10px 0;border-radius:8px;background:white;}
.message{padding:6px 10px;border-radius:10px;margin-bottom:5px;}
.message.user{background:#25d366;color:white;text-align:right;}
.message.ai{background:#ffca28;color:#111;text-align:left;}
input,textarea{width:100%;padding:10px;margin:6px 0;border:1px solid #ccc;border-radius:8px;}
footer{padding:15px;text-align:center;background:#111;color:#ffca28;font-size:14px;}
#progressContainer{width:100%;background:#ddd;border-radius:8px;overflow:hidden;margin:10px 0;}
#progressBar{width:0%;height:15px;background:#25d366;}
#countdown{font-weight:bold;margin-bottom:10px;}
.star{font-size:28px;cursor:pointer;opacity:0.4;}
.star.active{opacity:1;}
</style>
</head>
<body>

<nav>
  <a href="#">Impressum</a>
  <a href="#">Datenschutz</a>
  <a href="#">AGB</a>
</nav>

<header>
<h1>⚡ KI-Soforthilfe Stromausfall</h1>
<p>Digitale Soforthilfe für nur 39,99 €</p>
<button id="openCustomerBtn">Soforthilfe starten</button>
</header>

<!-- Kundendaten Modal -->
<div class="modal" id="customerModal">
<div class="modal-content">
<h2>Kundendaten</h2>
<input id="name" placeholder="Name">
<input id="address" placeholder="Adresse">
<input id="phone" placeholder="Telefon">
<input id="email" placeholder="E-Mail">
<label><input type="checkbox" id="consent"> Datenschutz akzeptiert</label>
<button id="startKiBtn" disabled>Weiter</button>
</div>
</div>

<!-- Zahlung Modal -->
<div class="modal" id="paymentModal">
<div class="modal-content">
<h2>Zahlung</h2>
<p id="paymentText"></p>
<button onclick="completePayment()">Zahlung simulieren</button>
</div>
</div>

<!-- KI Modal -->
<div class="modal" id="kiModal">
<div class="modal-content">
<h2>KI-Assistenz</h2>
<div class="info-box">⚠ Arbeiten an Strom sind gefährlich.</div>
<div id="progressContainer"><div id="progressBar"></div></div>
<div id="countdown">02:00</div>
<div id="messages"></div>
<input id="userInput" placeholder="Problem beschreiben...">
<button id="sendBtn">Senden</button>
</div>
</div>

<!-- Eskalation Modal -->
<div class="modal" id="escalationModal">
<div class="modal-content">
<h2>KI beendet</h2>
<p>Benötigen Sie einen Fachmann?</p>
<button id="expertBtn">Fachmann anfordern (99,99 €)</button>
</div>
</div>

<!-- Rating Modal -->
<div class="modal" id="ratingModal">
<div class="modal-content">
<h2>Ihre Bewertung</h2>
<div id="starContainer">
<span class="star" data-value="1">⭐</span>
<span class="star" data-value="2">⭐</span>
<span class="star" data-value="3">⭐</span>
<span class="star" data-value="4">⭐</span>
<span class="star" data-value="5">⭐</span>
</div>
<textarea id="ratingText" placeholder="Optionales Feedback"></textarea>
<button id="submitRatingBtn" disabled>Bewertung absenden</button>
</div>
</div>

<footer>© 2026 KI-Soforthilfe</footer>

<script>
// Grundelemente
const customerModal=document.getElementById("customerModal");
const paymentModal=document.getElementById("paymentModal");
const kiModal=document.getElementById("kiModal");
const escalationModal=document.getElementById("escalationModal");
const ratingModal=document.getElementById("ratingModal");

const startKiBtn=document.getElementById("startKiBtn");
const consent=document.getElementById("consent");

const expertWhatsAppNumber="4915145932462"; // Fachmann Nummer ohne +

document.getElementById("openCustomerBtn").onclick=()=>customerModal.style.display="flex";
consent.onchange=()=>startKiBtn.disabled=!consent.checked;

// Weiter zu Payment
startKiBtn.onclick=()=>{
  customerModal.style.display="none";
  document.getElementById("paymentText").textContent="KI-Service 39,99 €";
  paymentModal.style.display="flex";
};

// Payment Abschluss
function completePayment(){
  paymentModal.style.display="none";

  const paymentText=document.getElementById("paymentText").textContent;

  if(paymentText.includes("KI-Service")){
    kiModal.style.display="flex";
    addMessage("KI: Bitte prüfen Sie Sicherungen und FI-Schalter.","ai");
    startKiSession();
  }
  else if(paymentText.includes("Fachmann-Service")){
    const name=document.getElementById("name").value;
    const address=document.getElementById("address").value;
    const phone=document.getElementById("phone").value;
    const email=document.getElementById("email").value;

    const message=encodeURIComponent(
      `Hallo, ich benötige einen Fachmann.\n\nName: ${name}\nAdresse: ${address}\nTelefon: ${phone}\nE-Mail: ${email}\n\nBitte um Terminvereinbarung.`
    );

    window.open(`https://wa.me/${expertWhatsAppNumber}?text=${message}`, "_blank");

    ratingModal.style.display="flex";
  }
}

// Chat-Funktion KI
function addMessage(text,type){
  const div=document.createElement("div");
  div.className="message "+type;
  div.textContent=text;
  document.getElementById("messages").appendChild(div);
}

document.getElementById("sendBtn").onclick=()=>{
  const input=document.getElementById("userInput");
  if(!input.value) return;
  addMessage(input.value,"user");
  input.value="";
  setTimeout(()=>addMessage("KI: Bitte prüfen Sie Sicherungen & FI.","ai"),1000);
};

// Timer KI
function startKiSession(){
  let time=120;
  const bar=document.getElementById("progressBar");
  const countdown=document.getElementById("countdown");
  const interval=setInterval(()=>{
    time--;
    bar.style.width=((120-time)/120*100)+"%";
    countdown.textContent=`${Math.floor(time/60)}:${String(time%60).padStart(2,'0')}`;
    if(time<=0){
      clearInterval(interval);
      kiModal.style.display="none";
      ratingModal.style.display="flex";
    }
  },1000);
}

// Bewertung
let selectedRating=0;
document.querySelectorAll(".star").forEach(star=>{
  star.onclick=()=>{
    selectedRating=star.dataset.value;
    document.querySelectorAll(".star").forEach(s=>s.classList.remove("active"));
    for(let i=0;i<selectedRating;i++){
      document.querySelectorAll(".star")[i].classList.add("active");
    }
    document.getElementById("submitRatingBtn").disabled=false;
  };
});

document.getElementById("submitRatingBtn").onclick=()=>{
  console.log("Bewertung:", selectedRating, document.getElementById("ratingText").value);
  ratingModal.style.display="none";
  // Wenn KI fertig, nun Fachmann-Upsell
  if(document.getElementById("paymentText").textContent.includes("KI-Service")){
    escalationModal.style.display="flex";
  }
};

// Fachmann Button
document.getElementById("expertBtn").onclick=()=>{
  escalationModal.style.display="none";
  document.getElementById("paymentText").textContent="Fachmann-Service 99,99 €";
  paymentModal.style.display="flex";
};
</script>

</body>
</html>
